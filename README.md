# **Linuxæ­å»ºfrpæœåŠ¡ï¼Œå®ç°å†…ç½‘ç©¿é€æœåŠ¡ï¼Œå®ç°å¤–ç½‘åˆ°å†…ç½‘çš„åœ¨çº¿è®¿é—®**

## **ä¸€ï¼šfrpç®€ä»‹**

### **frp æ˜¯ä»€ä¹ˆï¼Ÿ**

frp é‡‡ç”¨ Golang ç¼–å†™ï¼Œæ”¯æŒè·¨å¹³å°ï¼Œä»…éœ€ä¸‹è½½å¯¹åº”å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶å³å¯æ‰§è¡Œï¼Œæ²¡æœ‰é¢å¤–ä¾èµ–ã€‚

frp æ˜¯ä¸€ä¸ªä¸“æ³¨äºå†…ç½‘ç©¿é€çš„é«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ï¼Œæ”¯æŒ TCPã€UDPã€HTTPã€HTTPS ç­‰å¤šç§åè®®ã€‚å¯ä»¥å°†å†…ç½‘æœåŠ¡ä»¥å®‰å…¨ã€ä¾¿æ·çš„æ–¹å¼é€šè¿‡å…·æœ‰å…¬ç½‘ IP èŠ‚ç‚¹çš„ä¸­è½¬æš´éœ²åˆ°å…¬ç½‘ã€‚

å¸‚é¢ä¸Šä¸€äº›ä¸»æµçš„å†…ç½‘ç©¿é€å·¥å…·æœ‰ï¼šNgrokï¼ŒNatappï¼ŒèŠ±ç”Ÿå£³ï¼ŒSshã€autosshï¼ŒFrpï¼ŒLanproxyï¼ŒSpikeã€‚

è¿™é‡Œä»‹ç»ä½¿ç”¨frpå·¥å…·ã€‚

Ngrokå¯å‚è€ƒæˆ‘å¦ä¸€ç¯‡æ–‡ç« ï¼šæ­å»ºngrokæœåŠ¡å™¨ï¼Œå®ç°å†…ç½‘ç©¿é€æœåŠ¡

## **äºŒï¼šå®‰è£…frp**

### **1ï¼šå‡†å¤‡ä¸€å°å…¬ç½‘æœåŠ¡å™¨ï¼ˆé…ç½®æ— è¦æ±‚ç½‘ç»œç¨³å®šå°±è¡Œï¼‰ï¼Œä½œä¸ºæœåŠ¡å™¨ç«¯ï¼Œå¦‚å…¬ç½‘IPï¼š123.32.12.32ã€‚**

å†…ç½‘å®¢æˆ·ç«¯ï¼ˆå‡†å¤‡è¦ç©¿é€å‡ºå»çš„è®¾å¤‡ï¼‰ï¼Œå®¢æˆ·ç«¯ï¼Œå¦‚å†…ç½‘IPï¼š192.168.152.103ã€‚

### **2ï¼šä¸‹è½½è§£å‹å®‰è£…åŒ…**

githubåœ°å€ï¼š[https://github.com/fatedier/frp](https://github.com/fatedier/frp),å¯ä»¥åœ¨ Release é¡µé¢ä¸­ä¸‹è½½åˆ°æœ€æ–°ç‰ˆæœ¬çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€æœ‰æ–‡ä»¶è¢«æ‰“åŒ…åœ¨ä¸€ä¸ªå‹ç¼©åŒ…ä¸­ã€‚

æ‰¾åˆ°è‡ªå·±Linuxåˆé€‚çš„ç‰ˆæœ¬ï¼Œä¸‹è½½ï¼Œä¸»æµLinuxç‰ˆæœ¬åŸºæœ¬ä¸Šéƒ½æ˜¯amd64ã€‚

```
#ä¸‹è½½
wget https://github.com/fatedier/frp/releases/download/v0.44.0/frp_0.44.0_linux_amd64.tar.gz
#è§£å‹
tar -zxvf frp_0.44.0_linux_amd64.tar.gz
#è¿›å…¥ç›®å½•
cd frp_0.44.0_linux_amd64/
```

è¿›å…¥æ–‡ä»¶å¤¹ï¼Œæœ‰ä¸¤ä¸ªåç§°æ–‡ä»¶frpcï¼ˆcç»“å°¾ä»£è¡¨clientï¼‰å’Œfrpsï¼ˆsç»“å°¾ä»£è¡¨serverï¼‰ï¼Œåˆ†åˆ«æ˜¯æœåŠ¡ç«¯ç¨‹åºå’ŒæœåŠ¡ç«¯é…ç½®ç¨‹åºã€‚

éœ€è¦å°†frpcæ‹·è´è‡³å®¢æˆ·ç«¯ï¼Œå³å†…ç½‘æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨å®¢æˆ·ç«¯ç›´æ¥ä¸‹è½½ä¹Ÿå¯ä»¥ï¼Œå®¢æˆ·ç«¯åªéœ€è¦ä½¿ç”¨frpcæ–‡ä»¶å³å¯ã€‚

### **3: èµ‹äºˆæ‰§è¡Œå‘½ä»¤æƒé™**

```
sudo chmod 755 ./frps
```

## **ä¸‰ï¼šé…ç½®æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ï¼ŒåŠå¯åŠ¨**

### **1ï¼šé…ç½®æœåŠ¡å™¨ç«¯frps.iniæ–‡ä»¶**

è¿™é‡Œæ˜¯ä¸ºæœåŠ¡ç«¯é…ç½®frp åªå…³æ³¨frpså’Œfrps.iniå³å¯ï¼ŒåŸå§‹æœ€ç®€å•é…ç½®ä¸ºã€‚

```
cat frps.ini
[common]
#éš§é“é€šé“ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é€šè¿‡æ­¤ç«¯å£é€šè®¯
bind_port = 7000
```

æœ€ç®€å•ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå…ˆä¸é…ç½®å…¶ä»–æµ‹è¯•ä½¿ç”¨å…ˆã€‚

### **2ï¼šé…ç½®å®¢æˆ·ç«¯frpc.iniæ–‡ä»¶**

åªå…³æ³¨frpcå’Œfrpc.iniå³å¯ï¼Œä¿®æ”¹frpc.iniã€‚

```
vim frpc.ini

[common]
#bind_portï¼šè¡¨ç¤ºç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿æ¥çš„ç«¯å£ï¼Œè¿™ä¸ªç«¯å£å·æˆ‘ä»¬ä¹‹ååœ¨é…ç½®å®¢æˆ·ç«¯çš„æ—¶å€™è¦ç”¨åˆ°
bind_port = 7000

#dashboard_portï¼šæ˜¯æœåŠ¡ç«¯ä»ªè¡¨æ¿çš„ç«¯å£ï¼Œè‹¥ä½¿ç”¨7500ç«¯å£ï¼Œåœ¨é…ç½®å®ŒæˆæœåŠ¡å¯åŠ¨åå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—® x.x.x.x:7500 ï¼ˆå…¶ä¸­x.x.x.xä¸ºå…¬ç½‘æœåŠ¡å™¨çš„IPï¼‰æŸ¥çœ‹frpæœåŠ¡è¿è¡Œä¿¡æ¯
dashboard_port = 7500
#tokenæ˜¯ï¼šç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿æ¥çš„å£ä»¤ï¼Œè¯·è‡ªè¡Œè®¾ç½®å¹¶è®°å½•ï¼Œç¨åä¼šç”¨åˆ°
token = 12345678
#dashboard_userã€dashboard_pwdï¼šè¡¨ç¤ºæ‰“å¼€ä»ªè¡¨æ¿é¡µé¢ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè‡ªè¡Œè®¾ç½®å³å¯
dashboard_user = admin
dashboard_pwd = 123456

#å¼€å¯sshè¿æ¥é…ç½®
[ssh]
type = tcp
#æœ¬æœºIP
local_ip = 127.0.0.1
#æœ¬æœºéœ€è¦æ˜ å°„çš„ç«¯å£22
local_port = 22
#è¿œç¨‹æœåŠ¡å™¨æ˜ å°„çš„ç«¯å£ä¸º6000
remote_port = 6000
```

## **3ï¼šåˆ†åˆ«å¯åŠ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯**

**æ³¨ï¼šæœåŠ¡å™¨ï¼Œå¦‚æœ‰é˜²ç«å¢™ï¼Œè¯·å¼€å¯7000ç«¯å£å’Œæœ‰éœ€è¦çš„ç«¯å£ã€‚**

æœåŠ¡å™¨è¿è¡Œå¯åŠ¨ï¼š

```
./frps -c frps.ini
```

å®¢æˆ·ç«¯è¿è¡Œå¯åŠ¨ï¼š

```
./frpc -c frpc.ini
```

å¯ä»¥çœ‹åˆ°æç¤ºï¼Œéƒ½å·²ç»å¯åŠ¨æˆåŠŸ

æµ‹è¯•sshè¿æ¥ï¼Œè¿™é‡Œç”¨ç¬¬ä¸‰æ–¹å·¥å…·xshellæµ‹è¯•ã€‚
è¿æ¥IP ä¸ºå…¬ç½‘IPåœ°å€ï¼Œç«¯å£ä¸º6000ç«¯å£ã€‚

è¿æ¥ç™»å½•ï¼Œå³å¯ç™»å½•åˆ°å†…ç½‘çš„192.168.152.103æœºå™¨ã€‚

æœ€ç®€å•çš„sshç«¯å£æ˜ å°„å°±å®Œæˆäº†ã€‚

## **å››ï¼šåå°å¯åŠ¨**

æœåŠ¡ç«¯ï¼š

```
nohup  ./frps -c frps.ini > /var/log/frp.log 2>&1  &
```

å®¢æˆ·ç«¯:

```
nohup ./frpc -c frpc.ini > /opt/frp/frp.log 2>&1 &
```

åˆ°æ­¤ï¼ŒfrpæœåŠ¡å™¨æ­å»ºå®Œæˆã€‚

## **äº”ã€é…ç½®åå°å¯åŠ¨æœåŠ¡**

## **linux**

### **1.åˆ›å»ºserviceæ–‡ä»¶**

`touch /etc/systemd/system/frp.service`

### **2.ç¼–è¾‘serviceæ–‡ä»¶**

æ‰“å¼€serviceæ–‡ä»¶

ğŸ’¡ `vi /etc/systemd/system/frp.service`

å¡«å…¥ä»¥ä¸‹å†…å®¹**(æ³¨æ„ä¿®æ”¹frpæ–‡ä»¶å¤¹è·¯å¾„)**

```
[Unit]
Description=frp daemon

[Service]
Type=simple
User=root
ExecStart=/opt/frp/frp_0.44.0_linux_amd64/frpc -c /opt/frp/frp_0.44.0_linux_amd64/frpc.ini
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

ä¿å­˜å¹¶é€€å‡º

### **3.é‡æ–°åŠ è½½systemctl daemon**

ğŸ’¡ `systemctl daemon-reload`

### **4.å¯åŠ¨frp**

ğŸ’¡ `systemctl start frp.service`

### **5.è®¾ç½®frpå¼€æœºè‡ªå¯åŠ¨**

ğŸ’¡ `systemctl enable frp.service`

### **ä»¥ä¸‹ä¸ºfrpç›¸å…³çš„ç®¡ç†å‘½ä»¤**

### **å¯åŠ¨frp**

ğŸ’¡`systemctl start frp.service`

### **é‡å¯frp**

ğŸ’¡`systemctl restart frp.service`

## **æŸ¥çœ‹frpè¿è¡ŒçŠ¶æ€**

ğŸ’¡`systemctl status frp.service`

## **æŸ¥è¯¢æ—¥å¿—**

### **æŸ¥çœ‹æŒ‡å®šæœåŠ¡æ—¥å¿—**

`journalctl -u æœåŠ¡å`

æŸ¥çœ‹æŒ‡å®šæ—¥æœŸæ—¥å¿—

`journalctl --since="2021-10-10 10:10:00" --until="2021-10-11 10:10:00" -u æœåŠ¡å`
ç±»ä¼¼tail -f  `journalctl -f -n 20 -u æœåŠ¡å-n æŸ¥çœ‹å°¾éƒ¨å¤šå°‘è¡Œ-f æ»šåŠ¨å½¢å¼`
æŸ¥çœ‹æ—¥å¿—å ç”¨çš„ç£ç›˜ç©ºé—´ `journalctl --disk-usage`

---

## **windows**

å› ä¸ºè¦è®¾ç½®æˆå¼€æœºè‡ªå¯åŠ¨ï¼Œæ‰€ä»¥å¯ä»¥éœ€è¦å°†frpå®¢æˆ·ç«¯è®¾ç½®åå°è¿è¡Œ
è¿™é‡Œéœ€è¦å€ŸåŠ©å¦å¤–ä¸€ä¸ªè½¯ä»¶nssmï¼Œé™„ä¸Šnssmçš„ä¸‹è½½åœ°å€:https://nssm.cc/release/nssm-2.24.zip
ä¸‹è½½å®Œåç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€Powershellçª—å£,ç„¶åcdè¿›nssmçš„ç›®å½•åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

```
./nssm.exe install frp
```

è¿è¡Œåå¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/0b68069c3b06444cb035ec983f60195a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56CB5byf55qE5Y2a5a6i,size_17,color_FFFFFF,t_70,g_se,x_16)

Pathé€‰æ‹©frpc.exe,ç„¶åArgumentsé€‰æ‹©-c frpc.ini
å®Œæˆåï¼Œå¯ä»¥åœ¨windowsä¸­æœç´¢æœåŠ¡:

![](https://img-blog.csdnimg.cn/0add30c51a1e4ee49008d81aeae38030.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56CB5byf55qE5Y2a5a6i,size_20,color_FFFFFF,t_70,g_se,x_16)

å¦‚æœfrpæ²¡æœ‰å¯åŠ¨è¿›è¡Œå¯åŠ¨ï¼Œç„¶åæ£€æŸ¥æ˜¯ä¸æ˜¯è‡ªåŠ¨

å¯åŠ¨åå¯ä»¥é€šè¿‡æ£€æŸ¥ç«¯å£ç›‘å¬çŠ¶æ€çœ‹æ˜¯å¦æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤:

```
netstat -an | findstr frpæœåŠ¡å™¨çš„ç«¯å£
```

åˆ°è¿™ä¸€æ­¥å·²ç»å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œè¿›è¡Œè¿œç¨‹è¿æ¥ã€‚

# **windowé…ç½®è¿œç¨‹æ¡Œé¢è¿æ¥**

è¯¦è§ https://blog.csdn.net/qq_37207266/article/details/122717327
